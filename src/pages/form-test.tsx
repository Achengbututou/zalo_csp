import React from "react";
import { useForm, Controller } from "react-hook-form";
import { Box, Input, Button, Text, Radio, Checkbox, Switch, DatePicker } from "zmp-ui";

// 1. Define rawData as JS object directly (paste JSON here)
const rawData = {
    "wfData": [
        "{\"wfData\":[{\"id\":\"c9580706-1ed6-400f-8250-a1ba0104e2e4\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a set Approve_Status=N'12' \\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a set Approve_Status=N'01' \\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"submit\",\"x\":113,\"y\":360},{\"id\":\"58b1d70c-fe96-48d4-8057-5f52885a454a\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=case when M_is_E = 1 and is_All_Voucher = 0 then 23\\n\\t\\t\\t\\t\\t    when Leave_Day > 15 and M_is_E = 0 then 22\\n\\t\\t\\t\\t\\t\\twhen ((Leave_Day <= 15 and is_All_Voucher = 1) or (Leave_Day > 15 and M_is_E = 1 and is_All_Voucher = 1)) and need_HRD = 0 then 99 \\n\\t\\t\\t\\t\\t\\twhen ((Leave_Day <= 15 and is_All_Voucher = 1) or (Leave_Day > 15 and M_is_E = 1 and is_All_Voucher = 1)) and need_HRD = 1 then 24 end\\n    , m_Approve_Date = getdate()\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a \\nset Approve_Status=case when Approve_Status=N'12'  then Approve_Status else N'10'  end\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"x\":638,\"y\":370,\"name\":\"M Approve\"},{\"id\":\"eb888074-6683-45bb-8052-c1a876bfaea1\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a\\nset Approve_Status=case when is_All_Voucher = 0 then 32 \\n\\t\\t\\t\\t\\t\\twhen is_All_Voucher = 1 and need_HRD = 1 then 33\\n\\t\\t\\t\\t\\t\\telse 99 end\\n    , m_Approve_Date = getdate()\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a set Approve_Status=N'23' \\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"E Approve\",\"x\":1006,\"y\":370},{\"id\":\"dbe0fbdc-dda1-4cfe-9595-98ee241b4f7d\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'21' \\n, M_Approve_Date = getdate()\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a \\nset Approve_Status=case when Approve_Status=N'12'  then Approve_Status else N'10'  end\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"x\":638,\"y\":131,\"name\":\"M Reject\"},{\"id\":\"c07c09b1-56c6-49c7-989a-f7cf08ce9a84\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'99' \\n, HRD_Approve_Date = getdate()\\n, HRD_Approve_UserID=@userId2\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"SELECT case when Leave_Day > 15 and M_is_E <> 1 then 33 else 24 end\\nFROM FHIS_Leave_Header WHere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"x\":2353,\"y\":-169,\"name\":\"HRD Approve\"},{\"id\":\"5b314e20-62b6-4dfc-8723-5b0ffe22593b\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"\",\"sqlStr\":\"update a \\nset Approve_Status=N'31' \\n, E_Approve_Date = getdate()\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a set Approve_Status=N'23' \\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"E Reject\",\"x\":1006,\"y\":159},{\"id\":\"769812d0-2fb6-4d12-84bd-76c22dd67c34\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'41' \\n, HRD_Approve_Date = getdate()\\n, HRD_Approve_UserID=@userId2\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"SELECT case when Leave_Day > 15 and M_is_E <> 1 then 33 else 24 end\\nFROM FHIS_Leave_Header WHere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"x\":2012,\"y\":-253,\"name\":\"HRD Reject\"},{\"id\":\"58a5a403-3140-4a15-a3b3-f09b9add7a1b\",\"type\":\"gatewayInclusive\",\"conditions\":[{\"dbCode\":\"lrsystemdb\",\"sql\":\"SELECT * \\nFROM FHIS_Leave_Header WHere RID=@processId\\nand Leave_Day > 15 and M_is_E <> 1\",\"name\":\"需要E级批核\",\"type\":\"2\",\"code\":\"6fb61ae8-5ade-426e-8bdc-ac643f01fe01\"},{\"dbCode\":\"lrsystemdb\",\"sql\":\"SELECT * \\nFROM FHIS_Leave_Header WHere RID=@processId\\nand is_All_Voucher = 1 and (Leave_Day <= 15 or M_is_E = 1)\",\"name\":\"不需要上传\",\"type\":\"2\",\"code\":\"db466a95-d248-465c-8d59-7118c13e3844\"},{\"dbCode\":\"lrsystemdb\",\"sql\":\"SELECT * \\nFROM FHIS_Leave_Header WHere RID=@processId\\nand is_All_Voucher = 0 and (Leave_Day <= 15 or M_is_E = 1)\",\"name\":\"需要上传附件\",\"type\":\"2\",\"code\":\"f9177d86-9db7-4345-b62e-7c6f4cc56607\"}],\"isInit\":true,\"x\":760,\"y\":270},{\"id\":\"ca4fedfb-9a41-4d48-a8a9-14c924f544fb\",\"type\":\"endEvent\",\"isInit\":true,\"x\":2482,\"y\":277},{\"id\":\"c435c36c-5271-4ab3-83e9-192da7771768\",\"type\":\"gatewayInclusive\",\"conditions\":[{\"dbCode\":\"lrsystemdb\",\"sql\":\"select * from FHIS_Leave_Header\\nwhere is_All_Voucher = 1 and RID=@processId\",\"name\":\"已经上传完全部凭证\",\"type\":\"2\",\"code\":\"c55ef9ff-c4f6-4ca8-83dd-eaa86497e7fc\"},{\"dbCode\":\"lrsystemdb\",\"sql\":\"select * from FHIS_Leave_Header\\nwhere is_All_Voucher = 0 and RID=@processId\",\"name\":\"没有上传完所有凭证\",\"type\":\"2\",\"code\":\"22f89a94-194d-4791-a652-c576443249bd\"}],\"isInit\":true,\"x\":1127,\"y\":270},{\"id\":\"6bb71e56-cdab-497b-8a16-3086cbb75ffa\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"\",\"sqlStr\":\"update a\\nset Approve_Status=case when need_HRD = 0 then 99\\n\\t\\t\\twhen need_HRD = 1 and Approve_Status = 22 then 24 else 33 end\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a\\nset Approve_Status=case when Approve_Status = 24 then 22 else 32 end\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"已上传凭证\",\"x\":1399,\"y\":360},{\"id\":\"efef5d8a-b0c9-4b67-816b-d34f6b26ef4e\",\"type\":\"gatewayXor\",\"conditions\":[],\"isInit\":true,\"x\":1520,\"y\":270},{\"id\":\"4d3d9b40-1869-4632-9800-f6030af9cb5e\",\"type\":\"gatewayInclusive\",\"conditions\":[{\"dbCode\":\"lrsystemdb\",\"sql\":\"select a.*\\nfrom FHIS_Leave_Header a\\nleft join FHIS_Leave_Reason b on SUBSTRING(a.Emp_No,0,CHARINDEX('_',a.Emp_No)) = b.company_code and a.Leave_Type = b.Leave_Type\\nwhere a.RID=@processId \\nand b.need_HRD = 1 and (Emp_No like 'LF%' or Emp_No like 'MZ%' or Emp_No like 'JS%')\",\"name\":\"需要CSC HRD批核\",\"type\":\"2\",\"code\":\"d0642210-097b-456e-ad53-806efcb176f7\"},{\"dbCode\":\"lrsystemdb\",\"sql\":\"select a.*\\nfrom FHIS_Leave_Header a\\nleft join FHIS_Leave_Reason b on SUBSTRING(a.Emp_No,0,CHARINDEX('_',a.Emp_No)) = b.company_code and a.Leave_Type = b.Leave_Type\\nwhere a.RID=@processId \\nand b.need_HRD = 0\",\"name\":\"不需要HRD批核\",\"type\":\"2\",\"code\":\"ab6ebe9f-c389-4a09-ba11-722b879ef561\"},{\"dbCode\":\"lrsystemdb\",\"sql\":\"select a.*\\nfrom FHIS_Leave_Header a\\nleft join FHIS_Leave_Reason b on SUBSTRING(a.Emp_No,0,CHARINDEX('_',a.Emp_No)) = b.company_code and a.Leave_Type = b.Leave_Type\\nwhere a.RID=@processId \\nand b.need_HRD = 1 and (Emp_No like 'YJ%')\",\"name\":\"需要YJ HRD批核\",\"type\":\"2\",\"code\":\"bdaf0f76-20bd-4860-814d-c1bf15e6baa8\"},{\"dbCode\":\"lrsystemdb\",\"sql\":\"select a.*\\nfrom FHIS_Leave_Header a\\nleft join FHIS_Leave_Reason b on SUBSTRING(a.Emp_No,0,CHARINDEX('_',a.Emp_No)) = b.company_code and a.Leave_Type = b.Leave_Type\\nwhere a.RID=@processId \\nand b.need_HRD = 1 and (Emp_No like 'JW%')\",\"name\":\"需要JW HRD批核\",\"type\":\"2\",\"code\":\"29ad0206-cc28-4870-a9d9-e094550d2341\"}],\"isInit\":true,\"x\":1636,\"y\":270},{\"id\":\"775b048d-809d-485d-a0e1-7b0ac33cd3a9\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'99' \\n, HRD_Approve_Date = getdate()\\n, HRD_Approve_UserID=@userId2\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"SELECT case when Leave_Day > 15 and M_is_E <> 1 then 33 else 24 end\\nFROM FHIS_Leave_Header WHere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"HRD Approve\",\"x\":2326,\"y\":40},{\"id\":\"e30a290e-6f38-4c65-8d6a-c76ddc8731a7\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'41' \\n, HRD_Approve_Date = getdate()\\n, HRD_Approve_UserID=@userId2\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"SELECT case when Leave_Day > 15 and M_is_E <> 1 then 33 else 24 end\\nFROM FHIS_Leave_Header WHere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"HRD Reject\",\"x\":2003,\"y\":40},{\"id\":\"84fd4faf-99d0-4d61-bcf0-80b743c27a06\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'99' \\n, HRD_Approve_Date = getdate()\\n, HRD_Approve_UserID=@userId2\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"SELECT case when Leave_Day > 15 and M_is_E <> 1 then 33 else 24 end\\nFROM FHIS_Leave_Header WHere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"HRD Approve\",\"x\":2308,\"y\":343},{\"id\":\"3dec9453-63fc-45d5-8428-85bc51f82d30\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'41' \\n, HRD_Approve_Date = getdate()\\n, HRD_Approve_UserID=@userId2\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"SELECT case when Leave_Day > 15 and M_is_E <> 1 then 33 else 24 end\\nFROM FHIS_Leave_Header WHere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"name\":\"HRD Reject\",\"x\":1991,\"y\":352},{\"id\":\"936204f0-ea99-41c6-83fb-2a95ce2cc4ea\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status= case when Approve_Status = '12' then '10'  else Approve_Status end\\n    , Appraiser_UserDate = getdate()\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a \\nset Approve_Status=N'12' \\n  , Appraiser_UserDate = null\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"x\":396,\"y\":360,\"name\":\"Appraiser Approve\"},{\"id\":\"9cc8a331-4a9a-4666-893c-005934f7ea16\",\"type\":\"scriptTask\",\"executeType\":\"1\",\"sqlDb\":\"lrsystemdb\",\"sqlStr\":\"update a \\nset Approve_Status=N'11' \\n, Appraiser_UserDate = getdate()\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"sqlStrRevoke\":\"update a \\nset Approve_Status=N'12' \\n  ,Appraiser_UserDate = null\\nfrom FHIS_Leave_Header a \\nwhere RID=@processId\",\"apiUrl\":\"\",\"apiUrlRevoke\":\"\",\"ioc\":\"\",\"iocRevoke\":\"\",\"isInit\":true,\"x\":396,\"y\":172,\"name\":\"Appraiser Reject\"},{\"id\":\"9c4dcd23-69ae-41db-a9a7-29f611c8b6a0\",\"type\":\"myline\",\"from\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"to\":\"c9580706-1ed6-400f-8250-a1ba0104e2e4\",\"waypoint\":[{\"x\":68,\"y\":295},{\"x\":163,\"y\":295},{\"x\":163,\"y\":360}],\"lineConditions\":\"\",\"isInit\":true},{\"id\":\"d8828f6f-63ef-45a2-941d-1a8ad24f5ee9\",\"type\":\"myline\",\"from\":\"39fc565b-2b17-48a0-80da-f274541b05aa\",\"to\":\"58b1d70c-fe96-48d4-8057-5f52885a454a\",\"waypoint\":[{\"x\":629,\"y\":295},{\"x\":688,\"y\":295},{\"x\":688,\"y\":370}],\"lineConditions\":\"agree\",\"isInit\":true},{\"id\":\"50d5ba89-e303-4a36-b45a-a3fe5e6b5eb5\",\"type\":\"myline\",\"from\":\"d369cb07-81a0-486e-80f9-cef84b52ea21\",\"to\":\"eb888074-6683-45bb-8052-c1a876bfaea1\",\"waypoint\":[{\"x\":996,\"y\":295},{\"x\":1056,\"y\":295},{\"x\":1056,\"y\":370}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"6aa26b2b-5a4f-4e1c-8b21-a89ca326f736\",\"type\":\"myline\",\"from\":\"39fc565b-2b17-48a0-80da-f274541b05aa\",\"to\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"waypoint\":[{\"x\":579,\"y\":255},{\"x\":579,\"y\":109},{\"x\":50,\"y\":109},{\"x\":50,\"y\":274}],\"isInit\":true,\"lineConditions\":\"disagree\"},{\"id\":\"1aef6570-0d60-49b5-8b07-7ab4727a5668\",\"type\":\"myline\",\"from\":\"39fc565b-2b17-48a0-80da-f274541b05aa\",\"to\":\"dbe0fbdc-dda1-4cfe-9595-98ee241b4f7d\",\"waypoint\":[{\"x\":579,\"y\":255},{\"x\":579,\"y\":184},{\"x\":638,\"y\":184}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"2cec9873-cd98-4862-9fd9-a5cd307c3eff\",\"type\":\"myline\",\"from\":\"d369cb07-81a0-486e-80f9-cef84b52ea21\",\"to\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"waypoint\":[{\"x\":946,\"y\":255},{\"x\":946,\"y\":61},{\"x\":50,\"y\":61},{\"x\":50,\"y\":274}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"6172534b-4ff4-4d03-9da2-b1ac982af48e\",\"type\":\"myline\",\"from\":\"c7b73a72-c1c0-4a38-9921-d1fc56f31e25\",\"to\":\"c07c09b1-56c6-49c7-989a-f7cf08ce9a84\",\"waypoint\":[{\"x\":1981,\"y\":-72},{\"x\":2260,\"y\":-72},{\"x\":2260,\"y\":-129},{\"x\":2353,\"y\":-129}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"20d6f16a-9460-44c9-80be-c6acf8e8781f\",\"type\":\"myline\",\"from\":\"c7b73a72-c1c0-4a38-9921-d1fc56f31e25\",\"to\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"waypoint\":[{\"x\":1931,\"y\":-112},{\"x\":1931,\"y\":-214},{\"x\":1779,\"y\":-232},{\"x\":1779,\"y\":-300},{\"x\":50,\"y\":-300},{\"x\":50,\"y\":273}],\"isInit\":true,\"lineConditions\":\"disagree\"},{\"id\":\"5b2f110a-f8fb-442e-8993-c01c320ae5e3\",\"type\":\"myline\",\"from\":\"d369cb07-81a0-486e-80f9-cef84b52ea21\",\"to\":\"5b314e20-62b6-4dfc-8723-5b0ffe22593b\",\"waypoint\":[{\"x\":946,\"y\":255},{\"x\":946,\"y\":199},{\"x\":1006,\"y\":199}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"87211848-24d7-4f1c-a86c-31e40965471a\",\"type\":\"myline\",\"from\":\"c7b73a72-c1c0-4a38-9921-d1fc56f31e25\",\"to\":\"769812d0-2fb6-4d12-84bd-76c22dd67c34\",\"waypoint\":[{\"x\":1931,\"y\":-112},{\"x\":1931,\"y\":-213},{\"x\":2012,\"y\":-213}],\"isInit\":true,\"lineConditions\":\"disagree\"},{\"id\":\"c1cc94b6-62cf-477a-83fa-644f3d2b6cf2\",\"type\":\"myline\",\"from\":\"39fc565b-2b17-48a0-80da-f274541b05aa\",\"to\":\"58a5a403-3140-4a15-a3b3-f09b9add7a1b\",\"waypoint\":[{\"x\":629,\"y\":295},{\"x\":760,\"y\":295}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"b7b584f5-270f-4573-84cc-dd24243c9345\",\"type\":\"myline\",\"from\":\"58a5a403-3140-4a15-a3b3-f09b9add7a1b\",\"to\":\"d369cb07-81a0-486e-80f9-cef84b52ea21\",\"waypoint\":[{\"x\":785,\"y\":270},{\"x\":785,\"y\":201},{\"x\":905,\"y\":201},{\"x\":905,\"y\":252}],\"lineConditions\":\"6fb61ae8-5ade-426e-8bdc-ac643f01fe01\",\"isInit\":true},{\"id\":\"7443c785-97b1-4ff0-8877-db6506a48138\",\"type\":\"myline\",\"from\":\"58a5a403-3140-4a15-a3b3-f09b9add7a1b\",\"to\":\"4a47c408-e30b-437a-93f5-625144a9d078\",\"waypoint\":[{\"x\":810,\"y\":295},{\"x\":843,\"y\":295},{\"x\":843,\"y\":471},{\"x\":1326,\"y\":471},{\"x\":1326,\"y\":335}],\"isInit\":true,\"lineConditions\":\"f9177d86-9db7-4345-b62e-7c6f4cc56607\"},{\"id\":\"9ff1efac-8cc7-4888-96bf-1e0cad2d5bff\",\"type\":\"myline\",\"from\":\"c7b73a72-c1c0-4a38-9921-d1fc56f31e25\",\"to\":\"ca4fedfb-9a41-4d48-a8a9-14c924f544fb\",\"waypoint\":[{\"x\":1981,\"y\":-72},{\"x\":2500,\"y\":-72},{\"x\":2500,\"y\":277}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"fca75ddc-d40d-4cff-9ff0-3d9496f6bdae\",\"type\":\"myline\",\"from\":\"d369cb07-81a0-486e-80f9-cef84b52ea21\",\"to\":\"c435c36c-5271-4ab3-83e9-192da7771768\",\"waypoint\":[{\"x\":996,\"y\":295},{\"x\":1127,\"y\":295}],\"lineConditions\":\"agree\",\"isInit\":true},{\"id\":\"ab5fd0a1-256a-4db8-80cc-da5b1e31d658\",\"type\":\"myline\",\"from\":\"c435c36c-5271-4ab3-83e9-192da7771768\",\"to\":\"4a47c408-e30b-437a-93f5-625144a9d078\",\"waypoint\":[{\"x\":1177,\"y\":295},{\"x\":1276,\"y\":295}],\"lineConditions\":\"22f89a94-194d-4791-a652-c576443249bd\",\"isInit\":true},{\"id\":\"94756578-d342-4692-8162-de06dfec8780\",\"type\":\"myline\",\"from\":\"c435c36c-5271-4ab3-83e9-192da7771768\",\"to\":\"efef5d8a-b0c9-4b67-816b-d34f6b26ef4e\",\"waypoint\":[{\"x\":1152,\"y\":270},{\"x\":1152,\"y\":200},{\"x\":1545,\"y\":200},{\"x\":1545,\"y\":267}],\"lineConditions\":\"c55ef9ff-c4f6-4ca8-83dd-eaa86497e7fc\",\"isInit\":true},{\"id\":\"5ce1f304-bdc8-4006-8020-ed7ef2b2b05f\",\"type\":\"myline\",\"from\":\"4a47c408-e30b-437a-93f5-625144a9d078\",\"to\":\"6bb71e56-cdab-497b-8a16-3086cbb75ffa\",\"waypoint\":[{\"x\":1376,\"y\":295},{\"x\":1449,\"y\":295},{\"x\":1449,\"y\":360}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"b7142dd5-5281-4de4-9576-d22278993a47\",\"type\":\"myline\",\"from\":\"58a5a403-3140-4a15-a3b3-f09b9add7a1b\",\"to\":\"efef5d8a-b0c9-4b67-816b-d34f6b26ef4e\",\"waypoint\":[{\"x\":785,\"y\":320},{\"x\":785,\"y\":507},{\"x\":1545,\"y\":507},{\"x\":1545,\"y\":324}],\"lineConditions\":\"db466a95-d248-465c-8d59-7118c13e3844\",\"isInit\":true},{\"id\":\"fad7a9f5-57c0-48c6-9813-7061fddef989\",\"type\":\"myline\",\"from\":\"4a47c408-e30b-437a-93f5-625144a9d078\",\"to\":\"efef5d8a-b0c9-4b67-816b-d34f6b26ef4e\",\"waypoint\":[{\"x\":1376,\"y\":295},{\"x\":1520,\"y\":295}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"4d84401a-ce15-4543-8811-87b54ecbf93d\",\"type\":\"myline\",\"from\":\"efef5d8a-b0c9-4b67-816b-d34f6b26ef4e\",\"to\":\"4d3d9b40-1869-4632-9800-f6030af9cb5e\",\"waypoint\":[{\"x\":1570,\"y\":295},{\"x\":1636,\"y\":295}],\"lineConditions\":\"\",\"isInit\":true},{\"id\":\"b1fb0833-193d-4fb9-8de3-be96090aaabb\",\"type\":\"myline\",\"from\":\"4d3d9b40-1869-4632-9800-f6030af9cb5e\",\"to\":\"c7b73a72-c1c0-4a38-9921-d1fc56f31e25\",\"waypoint\":[{\"x\":1661,\"y\":270},{\"x\":1661,\"y\":-72},{\"x\":1881,\"y\":-72}],\"lineConditions\":\"d0642210-097b-456e-ad53-806efcb176f7\",\"isInit\":true},{\"id\":\"c64eb11e-a8b2-41bd-8ceb-9a6bd8c016f2\",\"type\":\"myline\",\"from\":\"4d3d9b40-1869-4632-9800-f6030af9cb5e\",\"to\":\"ca4fedfb-9a41-4d48-a8a9-14c924f544fb\",\"waypoint\":[{\"x\":1661,\"y\":320},{\"x\":1661,\"y\":611},{\"x\":2500,\"y\":611},{\"x\":2500,\"y\":313}],\"isInit\":true,\"lineConditions\":\"ab6ebe9f-c389-4a09-ba11-722b879ef561\"},{\"id\":\"6b1780e0-a558-499d-91a3-5e15e55462e2\",\"type\":\"myline\",\"from\":\"4d3d9b40-1869-4632-9800-f6030af9cb5e\",\"to\":\"9b563d86-8615-472b-8f76-fa20fe324204\",\"waypoint\":[{\"x\":1661,\"y\":320},{\"x\":1661,\"y\":499},{\"x\":1881,\"y\":499}],\"lineConditions\":\"29ad0206-cc28-4870-a9d9-e094550d2341\",\"isInit\":true},{\"id\":\"99314492-62c9-490b-bae1-0c6be2dde78b\",\"type\":\"myline\",\"from\":\"755fa960-0bec-47ae-95e5-e0ba802bff32\",\"to\":\"ca4fedfb-9a41-4d48-a8a9-14c924f544fb\",\"waypoint\":[{\"x\":1966,\"y\":199},{\"x\":2500,\"y\":199},{\"x\":2500,\"y\":277}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"699516a6-8f9e-4bfa-a469-950f433c8d80\",\"type\":\"myline\",\"from\":\"9b563d86-8615-472b-8f76-fa20fe324204\",\"to\":\"ca4fedfb-9a41-4d48-a8a9-14c924f544fb\",\"waypoint\":[{\"x\":1981,\"y\":499},{\"x\":2500,\"y\":499},{\"x\":2500,\"y\":313}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"46585925-9f7d-4e9d-b9da-8f47d3f94f06\",\"type\":\"myline\",\"from\":\"4d3d9b40-1869-4632-9800-f6030af9cb5e\",\"to\":\"755fa960-0bec-47ae-95e5-e0ba802bff32\",\"waypoint\":[{\"x\":1661,\"y\":270},{\"x\":1661,\"y\":200},{\"x\":1866,\"y\":200}],\"isInit\":true,\"lineConditions\":\"bdaf0f76-20bd-4860-814d-c1bf15e6baa8\"},{\"id\":\"a64d583e-1927-4526-87a7-1c6a827cf0cf\",\"type\":\"myline\",\"from\":\"755fa960-0bec-47ae-95e5-e0ba802bff32\",\"to\":\"775b048d-809d-485d-a0e1-7b0ac33cd3a9\",\"waypoint\":[{\"x\":1966,\"y\":199},{\"x\":2241,\"y\":199},{\"x\":2241,\"y\":80},{\"x\":2326,\"y\":80}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"2aadc09c-cb70-4995-83fa-df7d8ffef4d6\",\"type\":\"myline\",\"from\":\"755fa960-0bec-47ae-95e5-e0ba802bff32\",\"to\":\"e30a290e-6f38-4c65-8d6a-c76ddc8731a7\",\"waypoint\":[{\"x\":1916,\"y\":159},{\"x\":1916,\"y\":95},{\"x\":2003,\"y\":95}],\"isInit\":true,\"lineConditions\":\"disagree\"},{\"id\":\"59a01827-af5f-4107-80e0-82c57db33efd\",\"type\":\"myline\",\"from\":\"9b563d86-8615-472b-8f76-fa20fe324204\",\"to\":\"84fd4faf-99d0-4d61-bcf0-80b743c27a06\",\"waypoint\":[{\"x\":1981,\"y\":499},{\"x\":2222,\"y\":499},{\"x\":2222,\"y\":383},{\"x\":2308,\"y\":383}],\"isInit\":true,\"lineConditions\":\"agree\"},{\"id\":\"fb0be932-b6cc-4549-82f3-5435de21bb74\",\"type\":\"myline\",\"from\":\"9b563d86-8615-472b-8f76-fa20fe324204\",\"to\":\"3dec9453-63fc-45d5-8428-85bc51f82d30\",\"waypoint\":[{\"x\":1931,\"y\":459},{\"x\":1931,\"y\":414},{\"x\":1991,\"y\":414}],\"isInit\":true,\"lineConditions\":\"disagree\"},{\"id\":\"81f8c9cb-ed7b-4c48-8bd2-3e7a16c7020b\",\"type\":\"myline\",\"from\":\"755fa960-0bec-47ae-95e5-e0ba802bff32\",\"to\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"waypoint\":[{\"x\":1916,\"y\":159},{\"x\":1916,\"y\":37},{\"x\":1777,\"y\":11},{\"x\":1777,\"y\":-298},{\"x\":50,\"y\":-298},{\"x\":50,\"y\":277}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"f299f036-f875-4c96-811c-e7d5c63b20b3\",\"type\":\"myline\",\"from\":\"9b563d86-8615-472b-8f76-fa20fe324204\",\"to\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"waypoint\":[{\"x\":1931,\"y\":459},{\"x\":1931,\"y\":358},{\"x\":1779,\"y\":338},{\"x\":1779,\"y\":-299},{\"x\":50,\"y\":-299},{\"x\":50,\"y\":277}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"484a6e34-6577-401b-8fb7-626586cf3ab5\",\"type\":\"myline\",\"from\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"to\":\"abe18cbf-0c38-455f-9c67-7b044f51dc12\",\"waypoint\":[{\"x\":68,\"y\":295},{\"x\":263,\"y\":295}],\"lineConditions\":\"\",\"isInit\":true},{\"id\":\"fafe4b9e-5113-478a-8ed5-8b79cf1cfca8\",\"type\":\"myline\",\"from\":\"abe18cbf-0c38-455f-9c67-7b044f51dc12\",\"to\":\"39fc565b-2b17-48a0-80da-f274541b05aa\",\"waypoint\":[{\"x\":363,\"y\":295},{\"x\":529,\"y\":295}],\"lineConditions\":\"agree\",\"isInit\":true},{\"id\":\"899292d9-30e2-4976-88e8-0b9e742e3e54\",\"type\":\"myline\",\"from\":\"abe18cbf-0c38-455f-9c67-7b044f51dc12\",\"to\":\"936204f0-ea99-41c6-83fb-2a95ce2cc4ea\",\"waypoint\":[{\"x\":363,\"y\":295},{\"x\":446,\"y\":295},{\"x\":446,\"y\":360}],\"lineConditions\":\"agree\",\"isInit\":true},{\"id\":\"ff64df91-b997-49a7-b499-ccb1c6cb011c\",\"type\":\"myline\",\"from\":\"abe18cbf-0c38-455f-9c67-7b044f51dc12\",\"to\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"waypoint\":[{\"x\":313,\"y\":255},{\"x\":313,\"y\":171},{\"x\":50,\"y\":171},{\"x\":50,\"y\":273}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"7d17899b-3ce7-4a46-822e-49f8d5b551ea\",\"type\":\"myline\",\"from\":\"abe18cbf-0c38-455f-9c67-7b044f51dc12\",\"to\":\"9cc8a331-4a9a-4666-893c-005934f7ea16\",\"waypoint\":[{\"x\":313,\"y\":255},{\"x\":313,\"y\":212},{\"x\":396,\"y\":212}],\"lineConditions\":\"disagree\",\"isInit\":true},{\"id\":\"f9a00383-5ea7-45a7-8147-8a274073a93b\",\"type\":\"startEvent\",\"isNextAuditor\":false,\"isCustmerTitle\":false,\"isDelete\":false,\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"2\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"HRATTF_HRATTF001\",\"formAppUrl\":\"/pagesHRATTF/hrattF001/single\",\"authFields\":[{\"prop\":\"Entity_Add\",\"field\":\"\",\"label\":\"请假申请\",\"required\":false,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"1694506136091_6742\",\"field\":\"\",\"label\":\"我要申请\",\"required\":false,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"1694506138485_1752\",\"field\":\"\",\"label\":\"我的申请\",\"required\":false,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_rid\",\"field\":\"RID\",\"label\":\"RID\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_leave_Note_NO\",\"field\":\"Leave_Note_NO\",\"label\":\"单号\",\"required\":false,\"isEdit\":false,\"isLook\":false,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_submit_UserID\",\"field\":\"Submit_UserID\",\"label\":\"填单人\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_leave_Submit_Date\",\"field\":\"Leave_Submit_Date\",\"label\":\"提交日期\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_leave_Type\",\"field\":\"Leave_Type\",\"label\":\"请假类型\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_year\",\"field\":\"year\",\"label\":\"\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_leave_Way\",\"label\":\"请假方式\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_from_Date\",\"field\":\"From_Date\",\"label\":\"请假日期\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_to_Date\",\"field\":\"To_Date\",\"label\":\"\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_leave_Shift_Item\",\"field\":\"Leave_Shift_Item\",\"label\":\"请假时段\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_from_Time\",\"field\":\"From_Time\",\"label\":\"请假时间\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_to_Time\",\"field\":\"To_Time\",\"label\":\"\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_remark\",\"field\":\"Remark\",\"label\":\"备注\",\"required\":false,\"isEdit\":false,\"isLook\":false,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_m_Approve_UserID\",\"field\":\"M_Approve_UserID\",\"label\":\"批核人\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"RID\",\"field\":\"\",\"label\":\"设计子表\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"Voucher_Type\",\"field\":\"RID\",\"label\":\"GUID主键\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"File_Url\",\"field\":\"Voucher_Type\",\"label\":\"凭证类型\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveDetailList\",\"field\":\"File_Url\",\"label\":\"\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_signature\",\"field\":\"signature\",\"label\":\"电子签名\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"Entity_M_Approve\",\"field\":\"\",\"label\":\"批核\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_m_Approve_Date\",\"field\":\"M_Approve_Date\",\"label\":\"批核时间\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_m_Approve_Status\",\"field\":\"M_Approve_Status\",\"label\":\"批核\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"Entity_E_Approve\",\"field\":\"\",\"label\":\"批核\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_e_Approve_UserID\",\"field\":\"E_Approve_UserID\",\"label\":\"批核人\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_e_Approve_Date\",\"field\":\"E_Approve_Date\",\"label\":\"批核时间\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_e_Approve_Status\",\"field\":\"E_Approve_Status\",\"label\":\"批核\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"Entity_HRD_Approve\",\"field\":\"\",\"label\":\"HRD复核\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_hrD_Approve_UserID\",\"field\":\"HRD_Approve_UserID\",\"label\":\"复核人\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_hrD_Approve_Date\",\"field\":\"HRD_Approve_Date\",\"label\":\"复核时间\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false},{\"prop\":\"fhisLeaveHeaderEntity_hrD_Approve_Status\",\"field\":\"HRD_Approve_Status\",\"label\":\"HRD复核结果\",\"required\":true,\"isEdit\":true,\"isLook\":true,\"_isHover\":false}],\"messageType\":\"2,3\",\"isInit\":true,\"x\":32,\"y\":277,\"strokeColor\":\"#000\"},{\"id\":\"39fc565b-2b17-48a0-80da-f274541b05aa\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"autoAgree\":\"2\",\"noAuditor\":\"3\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"4,3,2\",\"auditUsers\":[{\"dbCode\":\"lrsystemdb\",\"table\":\"FHIS_Leave_Header\",\"rfield\":\"RID\",\"auditorField\":\"M_Approve_UserID\",\"type\":\"6\",\"name\":\"FHIS_Leave_Header【M_Approve_UserID】\",\"_isHover\":false}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"请假申请-M级批核\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":true,\"overtimeMessageType\":\"2,3,4\",\"overtimeMessageStart\":24,\"overtimeMessageInterval\":72,\"isOvertimeGo\":false,\"overtimeGo\":12,\"isInherit\":true,\"isInit\":true,\"x\":529,\"y\":255,\"strokeColor\":\"#000\",\"isUpdateAuditor\":true},{\"id\":\"d369cb07-81a0-486e-80f9-cef84b52ea21\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"autoAgree\":\"\",\"noAuditor\":\"1\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"4,3,2\",\"auditUsers\":[{\"dbCode\":\"lrsystemdb\",\"table\":\"FHIS_Leave_Header\",\"rfield\":\"RID\",\"auditorField\":\"E_Approve_UserID\",\"type\":\"6\",\"name\":\"FHIS_Leave_Header【E_Approve_UserID】\",\"_isHover\":false}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"请假申请-E级批核\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":false,\"overtimeMessageType\":\"\",\"overtimeMessageStart\":1,\"overtimeMessageInterval\":1,\"isOvertimeGo\":false,\"overtimeGo\":12,\"isInherit\":true,\"isInit\":true,\"x\":896,\"y\":255,\"strokeColor\":\"#000\",\"isUpdateAuditor\":true},{\"id\":\"c7b73a72-c1c0-4a38-9921-d1fc56f31e25\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"autoAgree\":\"\",\"noAuditor\":\"1\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"2,3,4\",\"auditUsers\":[{\"type\":\"2\",\"id\":\"33458c11-6fe2-4747-9762-060ae030839a\",\"name\":\"电子请假CSC HRD批核组\",\"condition\":\"\",\"_isHover\":false},{\"type\":\"2\",\"id\":\"209f577a-db14-48a1-a5d6-12e2a7c9fb1c\",\"name\":\"电子请假管理员组\",\"condition\":\"\",\"_isHover\":false}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"请假申请-CSC HRD 复核\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":false,\"overtimeMessageType\":\"\",\"overtimeMessageStart\":1,\"overtimeMessageInterval\":1,\"isOvertimeGo\":false,\"overtimeGo\":12,\"isInherit\":true,\"isInit\":true,\"x\":1881,\"y\":-112,\"strokeColor\":\"#000\",\"isUpdateAuditor\":true},{\"id\":\"4a47c408-e30b-437a-93f5-625144a9d078\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"autoAgree\":\"\",\"noAuditor\":\"1\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"\",\"auditUsers\":[{\"dbCode\":\"lrsystemdb\",\"table\":\"FHIS_Leave_Header\",\"rfield\":\"RID\",\"auditorField\":\"Submit_UserID\",\"type\":\"6\",\"name\":\"FHIS_Leave_Header【Submit_UserID】\",\"_isHover\":false}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"请假申请-待上传凭证\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":false,\"overtimeMessageType\":\"2,3,4\",\"overtimeMessageStart\":24,\"overtimeMessageInterval\":24,\"isOvertimeGo\":false,\"overtimeGo\":14,\"isInherit\":true,\"isInit\":true,\"x\":1276,\"y\":255,\"strokeColor\":\"#000\"},{\"id\":\"755fa960-0bec-47ae-95e5-e0ba802bff32\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"isUpdateAuditor\":true,\"autoAgree\":\"\",\"noAuditor\":\"1\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"2,3,4\",\"auditUsers\":[{\"type\":\"2\",\"id\":\"6866e62a-e7ab-4db9-b35a-3317c3c9c7ef\",\"name\":\"电子请假YJ HRD批核组\",\"condition\":\"\",\"_isHover\":false},{\"type\":\"2\",\"id\":\"209f577a-db14-48a1-a5d6-12e2a7c9fb1c\",\"name\":\"电子请假管理员组\",\"condition\":\"\",\"_isHover\":false}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"请假申请-YJ HRD 复核\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":false,\"overtimeMessageType\":\"\",\"overtimeMessageStart\":1,\"overtimeMessageInterval\":1,\"isOvertimeGo\":false,\"overtimeGo\":12,\"isInherit\":true,\"isInit\":true,\"x\":1866,\"y\":159,\"strokeColor\":\"#000\"},{\"id\":\"9b563d86-8615-472b-8f76-fa20fe324204\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"isUpdateAuditor\":true,\"autoAgree\":\"\",\"noAuditor\":\"1\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"2,3,4\",\"auditUsers\":[{\"type\":\"2\",\"id\":\"6200607f-974e-4c05-bae7-fde052722aa9\",\"name\":\"电子请假JW HRD批核组\",\"condition\":\"\",\"_isHover\":false},{\"type\":\"2\",\"id\":\"209f577a-db14-48a1-a5d6-12e2a7c9fb1c\",\"name\":\"电子请假管理员组\",\"condition\":\"\"}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"请假申请-JW HRD 复核\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":false,\"overtimeMessageType\":\"\",\"overtimeMessageStart\":1,\"overtimeMessageInterval\":1,\"isOvertimeGo\":false,\"overtimeGo\":12,\"isInherit\":true,\"isInit\":true,\"x\":1881,\"y\":459,\"strokeColor\":\"#000\"},{\"id\":\"abe18cbf-0c38-455f-9c67-7b044f51dc12\",\"type\":\"userTask\",\"isAddSign\":false,\"isTransfer\":false,\"isBatchAudit\":false,\"isUploadFile\":false,\"isPrint\":true,\"isUpdateAuditor\":true,\"autoAgree\":\"\",\"noAuditor\":\"1\",\"rejectType\":\"1\",\"rejectNeedForm\":false,\"messageType\":\"2,3,4\",\"auditUsers\":[{\"dbCode\":\"lrsystemdb\",\"table\":\"FHIS_Leave_Header\",\"rfield\":\"RID\",\"auditorField\":\"Appraiser_UserID\",\"type\":\"6\",\"name\":\"FHIS_Leave_Header【Appraiser_UserID】\"}],\"lookUsers\":[],\"printUsers\":[],\"formRelations\":[],\"formWrodPrintCode\":\"\",\"formType\":\"1\",\"formCode\":\"\",\"formVerison\":\"\",\"formRelationId\":\"\",\"formUrl\":\"\",\"formAppUrl\":\"\",\"authFields\":[],\"name\":\"直属上司批核\",\"btnlist\":[{\"code\":\"agree\",\"name\":\"同意\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true},{\"code\":\"disagree\",\"name\":\"驳回\",\"hidden\":false,\"isNextAuditor\":false,\"isSign\":false,\"isSys\":true}],\"isCountersign\":false,\"isCountersignAll\":false,\"countersignAgian\":\"1\",\"countersignType\":\"1\",\"countersignAllType\":100,\"isOvertimeMessage\":true,\"overtimeMessageType\":\"2,3,4\",\"overtimeMessageStart\":24,\"overtimeMessageInterval\":72,\"isOvertimeGo\":false,\"overtimeGo\":12,\"isInherit\":true,\"isInit\":true,\"x\":263,\"y\":255,\"strokeColor\":\"#000\"}],\"keywordDb\":\"\",\"keywordTable\":\"\",\"keywordRField\":\"\",\"keywordSField\":\"\",\"undoType\":1,\"undoDbCode\":\"\",\"undoDbSQL\":\"\",\"undoIOCName\":\"\",\"undoUrl\":\"\",\"deleteType\":1,\"deleteDbCode\":\"\",\"deleteDbSQL\":\"\",\"deleteIOCName\":\"\",\"deleteUrl\":\"\",\"deleteDraftType\":1,\"deleteDraftDbCode\":\"\",\"deleteDraftDbSQL\":\"\",\"deleteDraftIOCName\":\"\",\"deleteDraftUrl\":\"\"}"
    ]
};

// 2. 字段类型推断（
function guessType(field) {
    if (/date|Date/i.test(field.label) || /date|Date/i.test(field.field)) return "date";
    if (/time|Time/i.test(field.label) || /time|Time/i.test(field.field)) return "text";
    if (/remark|备注/i.test(field.label)) return "textarea";
    if (/file|附件|凭证/i.test(field.label)) return "upload";
    if (/type|方式|类型/i.test(field.label)) return "select";
    if (/status|状态/i.test(field.label)) return "select";
    return "text";
}

// 3. 解析authFields为schema
// 修复：先将 rawData.wfData[0] 解析为对象数组
const wfDataObj = JSON.parse(rawData.wfData[0]);
const wfDataArr = wfDataObj.wfData;

function parseAuthFields(authFields) {
    // 允许 field 为空但 label 不为空的字段渲染（如标题、分组等）
    return authFields
        .filter(f => f.label)
        .map((f, idx) => ({
            name: f.field || `field_${idx}`,
            label: f.label,
            type: guessType(f),
            rules: f.required ? { required: "必填" } : {},
            readOnly: f.isEdit === false,
        }));
}

// 4. 解析btnlist为按钮
function parseButtons(btnlist) {
    return btnlist?.map(btn => ({ code: btn.code, name: btn.name })) || [];
}

// 5. 生成默认值
function getDefaultValueForField(field) {
    if (field.type === "checkbox") return [];
    if (field.type === "switch") return false;
    if (field.type === "upload") return [];
    return "";
}
function getDefaultValues(fields) {
    const obj = {};
    fields.forEach(f => {
        obj[f.name] = getDefaultValueForField(f);
    });
    return obj;
}

// 6. 渲染字段
function renderField(field, control, errors) {
    return (
        <Box key={field.name} className="my-2">
            <Text>{field.label}{field.rules?.required && <Text type="danger">*</Text>}</Text>
            <Controller
                control={control}
                name={field.name}
                rules={field.rules}
                render={({ field: controllerField }) => {
                    switch (field.type) {
                        case "text":
                            return <Input {...controllerField} disabled={field.readOnly} />;
                        case "textarea":
                            return <Input.TextArea {...controllerField} disabled={field.readOnly} />;
                        case "date":
                            return <DatePicker value={controllerField.value} onChange={controllerField.onChange} disabled={field.readOnly} />;
                        case "select":
                            return (
                                <select {...controllerField} className="zaui-input" disabled={field.readOnly}>
                                    <option value="">请选择</option>
                                    {/* 可根据业务扩展options */}
                                </select>
                            );
                        case "upload":
                            return <input type="file" onChange={e => controllerField.onChange(e.target.files)} multiple disabled={field.readOnly} />;
                        default:
                            return <Input {...controllerField} disabled={field.readOnly} />;
                    }
                }}
            />
            {errors && errors[field.name]?.message && (
                <Text type="danger" size="xSmall">{errors[field.name].message}</Text>
            )}
        </Box>
    );
}

// 7. 主组件
// 修复：遍历所有节点收集字段和按钮，避免类型报错
function parseAllAuthFields(wfData: any[]): any[] {
    const allFields: any[] = [];
    wfData.forEach((node: any) => {
        if (typeof node === 'object' && node && Array.isArray(node.authFields)) {
            node.authFields.forEach((f: any) => {
                if (f.label) allFields.push(f);
            });
        }
    });
    // 去重
    const seen = new Set();
    return allFields.filter(f => {
        const key = f.field || f.label;
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
    });
}
function parseAllButtons(wfData: any[]): any[] {
    const allBtns: any[] = [];
    wfData.forEach((node: any) => {
        if (typeof node === 'object' && node && Array.isArray(node.btnlist)) {
            node.btnlist.forEach((btn: any) => {
                if (btn.code && btn.name) allBtns.push(btn);
            });
        }
    });
    // 去重
    const seen = new Set();
    return allBtns.filter(btn => {
        if (seen.has(btn.code)) return false;
        seen.add(btn.code);
        return true;
    });
}
const authFields = parseAuthFields(parseAllAuthFields(wfDataArr));
const btnlist = parseAllButtons(wfDataArr);
const defaultValues = getDefaultValues(authFields);

const FormTest = () => {
    const { control, handleSubmit, formState: { errors }, reset } = useForm({
        defaultValues,
    });

    const onSubmit = (data) => {
        alert("提交数据：" + JSON.stringify(data, null, 2));
    };

    return (
        <Box p={4} className="bg-white h-full overflow-auto">
            <Text.Title>动态流程表单测试（基于后台JSON）</Text.Title>
            {authFields.map(field => renderField(field, control, errors))}
            <Box className="mt-4 flex space-x-2">
                {parseButtons(btnlist).map(btn => (
                    <Button key={btn.code} type="highlight" onClick={handleSubmit(onSubmit)}>{btn.name}</Button>
                ))}
                <Button type="neutral" onClick={() => reset()}>重置</Button>
            </Box>
        </Box>
    );
};

export default FormTest; 